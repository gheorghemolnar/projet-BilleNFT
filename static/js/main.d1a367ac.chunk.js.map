{"version":3,"sources":["contexts/EthContext/EthContext.js","contexts/EthContext/state.js","utils/index.js","contexts/EthContext/EthProvider.jsx","contexts/EthContext/useEth.js","components/Navbar/index.jsx","components/NoticeNoArtifact.jsx","components/NoticeWrongNetwork.jsx","components/Listing/index.jsx","components/FormEvent/index.jsx","components/ViewEvent/index.jsx","components/FormTicket/index.jsx","components/NoMatch/index.jsx","App.jsx","index.js"],"names":["EthContext","createContext","actions","initialState","artifact","web3","accounts","networkID","contract","contractBilleEvent","eventsCreated","ticketsSold","owner","reducer","state","action","type","data","evCreate","evTicketSold","Error","TICKET_CATEGORIES","TICKET_CATEGORIES_LABELS","getContractStoreByAddress","abi","address","eth","Contract","gasPrice","getContractEventByAddress","BilleEventABI","getContractCommByAddress","CommunicationABI","getDateFromTimestamp","date","Intl","DateTimeFormat","year","month","day","format","isOwner","currentUser","length","EthProvider","children","useReducer","dispatch","init","useCallback","Web3","givenProvider","requestAccounts","net","getId","initEvents","ticketSolds","initOwner","networks","contractBilleStore","contractCommunication","options","fromBlock","toBlock","Promise","all","methods","call","getPastEvents","console","error","useEffect","tryInit","require","err","events","handleChange","eventsSubscriptions","options1","subEvCreate","EventCreated","on","event","log","subTicketSold","TicketSold","forEach","e","window","ethereum","removeListener","Object","entries","key","subsription","unsubscribe","Provider","value","useEth","useContext","Navbar","className","id","href","src","alt","width","height","fill","NoticeNoArtifact","NoticeWrongNetwork","Listing","isAdmin","eventContent","to","map","returnValues","eventAddress","name","description","uri","dateEve","split","xmlns","role","preserveAspectRatio","focusable","x","y","dy","FormEvent","navigate","useNavigate","useForm","register","handleSubmit","useState","isLoading","setIsLoading","fileImg","setFileImg","onSubmit","nameEvent","sendFileToIPFS","cidImage","newData","handleCreateEvent","params","dateEvent","symbol","ticketSupply1","ticketSupply2","ticketSupply3","dateTimestamp","Number","Date","createEvent","send","from","eventName","timestamp","now","fileName","filePath","formData","FormData","append","axios","method","url","headers","process","resFile","IpfsHash","htmlFor","onChange","target","files","defaultValue","ViewEvent","setContractBilleEvent","balance","ticketsStats","stats","setStats","useParams","showEventStats","contractEvent","fetchData","getBalance","getEventStats","utils","fromWei","eventStats","eventStatsTickets","eventInfos","filter","currentEvent","i","placeholder","disabled","dotenv","config","errlist","setErrlist","errMessage","setErrMessage","category","quantity","ticketOrder","setTicketOrder","tmp","inputValue","addedTicketOrder","parseInt","handleTicketBuy","price","toWei","buyTickets","gas","preventDefault","stopPropagation","schema","Joi","object","number","min","max","required","joiResponse","validate","abortEarly","details","message","forhtml","checked","NoMatch","App","routes","path","element","Layout","index","useRoutes","ReactDOM","createRoot","document","getElementById","render","StrictMode"],"mappings":"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","file":"static/js/main.d1a367ac.chunk.js","sourcesContent":["import { createContext } from \"react\";\n\nconst EthContext = createContext();\n\nexport default EthContext;\n","const actions = {\n  INIT: \"INIT\",  \n  EVENT_CREATED: \"EVENT_CREATED\",\n  TICKET_SOLD: \"TICKET_SOLD\"\n};\n\nconst initialState = {\n  artifact: null,\n  web3: null,\n  accounts: [],\n  networkID: '',\n  contract: null,\n  contractBilleEvent: null,\n  eventsCreated: [],\n  ticketsSold: [],\n  owner: false\n};\n\nconst reducer = (state, action) => {\n  const { type, data } = action;\n  switch (type) {\n    case actions.INIT:\n      return { ...state, ...data };\n    case actions.EVENT_CREATED:\n        return {\n           ...state, \n           eventsCreated: [...state.eventsCreated, data.evCreate]\n          };\n    case actions.TICKET_SOLD:\n        return {\n            ...state,\n            ticketsSold: [...state.ticketsSold, data.evTicketSold]\n          };\n    default:\n      throw new Error(\"Undefined reducer action type\");\n  }\n};\n\nexport {\n  actions,\n  initialState,\n  reducer\n};\n","import BilleEventABI from \"../contracts/BilleEvent.json\";\nimport CommunicationABI from \"../contracts/Communication.json\";\n\nexport const TICKET_CATEGORIES = [0, 1, 2];\nexport const TICKET_CATEGORIES_LABELS = ['Fosse', 'Gradins', 'VIP'];\n\nexport const getStatsAsObject = (arrValues) => {\n    const result = {sales: [], supplies: []};\n\n    for (let i = 0; i<TICKET_CATEGORIES.length; i++) {\n        result['sales'].push(arrValues[i]);\n        result['supplies'].push(arrValues[i+3]);\n    }\n\n    return result;\n}\n\nexport const getContractStoreByAddress = (web3, abi, address) => {\n    const contract = new web3.eth.Contract(abi, address, {gasPrice: '20000000000'});\n    return contract;\n}\n\nexport const getContractEventByAddress = (web3, address) => {\n    const contract = new web3.eth.Contract(BilleEventABI.abi, address, {gasPrice: '20000000000'});\n    return contract;\n}\n\nexport const getContractCommByAddress = (web3, address) => {\n    const contract = new web3.eth.Contract(CommunicationABI.abi, address);\n    return contract;\n}\n\nexport const getDateFromTimestamp = (date) => {\n    const dateEvent = Intl.DateTimeFormat('fr-FR', { year: 'numeric', month: '2-digit', day: '2-digit' }).format(date);\n    return dateEvent;\n}\n\n// Is App Owner\nexport const isOwner = (currentUser, owner) => currentUser && currentUser.length > 0 ? currentUser[0] === owner : false;\n","import React, { useReducer, useCallback, useEffect } from \"react\";\nimport Web3 from \"web3\";\nimport EthContext from \"./EthContext\";\nimport { reducer, actions, initialState } from \"./state\";\nimport { getContractStoreByAddress, getContractEventByAddress, getContractCommByAddress } from '../../utils';\n\nfunction EthProvider({ children }) {\n  \n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  const init = useCallback(\n    async artifact => {\n      if (artifact) {\n        const web3 = new Web3(Web3.givenProvider || \"ws://localhost:8545\");\n        const accounts = await web3.eth.requestAccounts();\n        const networkID = await web3.eth.net.getId();\n        const { abi } = artifact;\n        let address, contractBilleStore, contractBilleEvent, contractCommunication;\n        let initEvents = [], ticketSolds = [];\n        let initOwner = false;\n        try {\n          address = artifact.networks[networkID].address;\n          contractBilleStore = getContractStoreByAddress(web3, abi, address);\n          contractBilleEvent = getContractEventByAddress(web3, address);\n          contractCommunication = getContractCommByAddress(web3, address);\n          \n          // On recup tous les events passés du contrat\n          if(contractBilleStore && contractBilleEvent) {\n            const options = { fromBlock: 0, toBlock: 'latest' };\n\n            [initOwner, initEvents, ticketSolds] = await Promise.all([\n              contractBilleStore.methods.owner().call(),\n              contractBilleStore.getPastEvents('EventCreated', options),\n              contractBilleEvent.getPastEvents('TicketSold', options)\n            ]);\n\n\n          }\n        } catch (err) {\n          console.error(err);\n        }\n        \n        dispatch({\n          type: actions.INIT,\n          data: { artifact, web3, accounts, networkID, \n            owner: initOwner, contractBilleStore, \n            contractBilleEvent, contractCommunication, \n            eventsCreated: [...initEvents], ticketsSold: [...ticketSolds] \n          }\n        });\n      }\n    }, []);\n    \n\n  useEffect(() => {\n    const tryInit = async () => {\n      try {\n        const artifact = require(\"../../contracts/BilleStore.json\");\n        init(artifact);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    tryInit();\n  }, [init]);\n\n  useEffect(() => {\n    const events = [\"chainChanged\", \"accountsChanged\"];\n    const handleChange = () => {\n      init(state.artifact);\n    };\n\n    const eventsSubscriptions = {};\n    const options1 = {fromBlock: 'latest'};\n\n    if(state.contractBilleStore) {\n      const subEvCreate = state.contractBilleStore.events.EventCreated(options1)\n      .on('connected', event => {\n        console.log(\"Les détails de l'évènement sont connu\", event);\n      })\n      .on('data', event => {\n        dispatch({\n          type: actions.EVENT_CREATED,\n          data: {\n            evCreate: event\n          }\n        })\n      });\n      // add subscription for Events\n      eventsSubscriptions['eventCreated'] = subEvCreate;\n    }\n\n    if(state.contractBilleEvent) {\n      const subTicketSold = state.contractBilleEvent.events.TicketSold(options1)\n      .on('connected', event => {\n        console.log(\"Les détails de l'évènement sont connu\", event);\n      })\n      .on('data', event => {\n        dispatch({\n          type: actions.TICKET_SOLD,\n          data: {\n            evTicketSold: event\n          }\n        })\n      });\n      // add subscription for Tickets\n      eventsSubscriptions['ticketSold'] = subTicketSold;\n    }\n\n    events.forEach(e => window.ethereum.on(e, handleChange));\n    return () => {\n      events.forEach(e => window.ethereum.removeListener(e, handleChange));\n      Object.entries(eventsSubscriptions).forEach(([key, subsription]) => {\n        console.log(\"Unsubscribe for \", key);\n        subsription.unsubscribe();\n      })\n    };\n  }, [init, state.artifact, state.contractBilleStore, state.contractBilleEvent], state.contractCommunication);\n\n  \n\n  return (\n    <EthContext.Provider value={{\n      state,\n      dispatch\n    }}>\n      {children}\n    </EthContext.Provider>\n  );\n}\n\nexport default EthProvider;\n","import { useContext } from \"react\";\nimport EthContext from \"./EthContext\";\n\nconst useEth = () => useContext(EthContext);\n\nexport default useEth;\n","import React from 'react';\n\nimport useEth from \"../../contexts/EthContext/useEth\";\n\nexport default function Navbar() {\n  const { state: { accounts } } = useEth();\n\n  return (\n    <header>\n      <div className=\"collapse bg-dark\" id=\"navbarHeader\">\n        <div className=\"container\">\n          <div className=\"row\">\n            <div className=\"col-sm-8 col-md-7 py-4\">          \n            </div>\n            <div className=\"col-sm-4 offset-md-1 py-4\">\n              <h4 className=\"text-white\">Contact</h4>\n              <ul className=\"list-unstyled\">\n                <li><a href=\"https://web3.corsica\" className=\"text-white\">Suivez nous sur Twitter</a></li>\n                <li><a href=\"https://web3.corsica\" className=\"text-white\">Mais aussi sur Facebook</a></li>\n                <li><a href=\"https://web3.corsica\" className=\"text-white\">Contactez nous</a></li>\n              </ul>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"navbar navbar-dark bg-dark shadow-sm\">\n        <div className=\"container\">\n          <a href=\"/\" className=\"navbar-brand d-flex align-items-center\">\n            <img src=\"https://web3.corsica/wp-content/uploads/2022/07/logo.png\" alt=\"logo\" width=\"211\" height=\"57\" fill=\"none\"></img>\n          </a>\n          <div className=\"center text-white\">Compte : { accounts[0] }</div>\n          <button className=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarHeader\" aria-controls=\"navbarHeader\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n            <span className=\"navbar-toggler-icon\"></span>\n          </button>\n        </div>\n      </div>\n    </header>\n  )\n}\n  ","import React from 'react';\n\nfunction NoticeNoArtifact() {\n  return (\n    <div className=\"container text-center\">\n      <div className=\"row  justify-content-center\">\n        <div className=\"col-5  align-self-center\">\n          <button type=\"button\" className=\"btn btn-info\">Afin d'utiliser notre site, veuillez vous connecter à MetaMask.</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default NoticeNoArtifact;\n","import React from 'react';\n\nfunction NoticeWrongNetwork() {\n  return (\n    <div className=\"container text-center\">\n      <div className=\"row  justify-content-center\">\n        <div className=\"col-5  align-self-center\">\n        <button type=\"button\" className=\"btn btn-warning\">Veuillez vérifier le réseau sur lequel MetaMask est connecté</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default NoticeWrongNetwork;\n","import React from 'react';\nimport { Link } from \"react-router-dom\";\n\nimport NoticeNoArtifact from \"../NoticeNoArtifact\";\nimport NoticeWrongNetwork from \"../NoticeWrongNetwork\";\nimport useEth from \"../../contexts/EthContext/useEth\";\nimport { getDateFromTimestamp, isOwner } from \"../../utils\";\n\nexport default function Listing() {\n  const { state: { artifact, contractBilleStore, eventsCreated, accounts, owner } } = useEth();\n\n  const isAdmin = isOwner(accounts, owner);\n  const eventHeader = <section key=\"header\" className=\"py-5 text-center container\">\n      <div className=\"row py-lg-5\">\n        <div className=\"col-lg-6 col-md-8 mx-auto\">\n          <h1 className=\"fw-light\">Liste des événements à venir</h1>\n          <p className=\"lead text-muted\">Vous souhaitez assister au concert de votre artiste préféré avec vos amis, offrir un billet de concert à l’un de vos proches, ou trouver la sortie idéale en amoureux.Avec BilleNFT vous n’aurez aucun mal à trouver en quelques clics un billet pour le concert de votre choix.</p>\n          <p>\n            {isAdmin && (<Link to=\"/addevent\" className=\"btn btn-primary\">Ajouter un événement</Link>)}\n          </p>\n        </div>\n      </div>\n    </section>;\n  \n  const eventList =\n    eventsCreated.map(({ returnValues }) => {\n      const { eventAddress, name, description, date, uri } = returnValues;\n      const dateEve = getDateFromTimestamp(date);\nconsole.log(`🚀  uri`, `${uri.split('//')[1]}`);\n\n      return <div className=\"col-lg-6 p-3\" key={returnValues.id}>\n        <div className=\"card shadow-sm\">\n          <img src={`https://gateway.pinata.cloud/ipfs/${uri.split('//')[1]}`} alt=\"eventImage\"/>\n          <svg className=\"bd-placeholder-img card-img-top\" width=\"100%\" height=\"225\" xmlns=\"http://www.w3.org/2000/svg\" role=\"img\" aria-label=\"Placeholder: Thumbnail\" preserveAspectRatio=\"xMidYMid slice\" focusable=\"false\"><title>Placeholder</title><rect width=\"100%\" height=\"100%\" fill=\"#55595c\" /><text x=\"50%\" y=\"50%\" fill=\"#eceeef\" dy=\".3em\">Thumbnail</text></svg>\n\n          <div className=\"card-body\">\n\n            <Link to={`/events/${eventAddress}`} >\n\n              <p className=\"card-text\">  {name} </p>\n              <p className=\"card-text\"> {description}</p>\n              <div className=\"d-flex justify-content-between align-items-center\">\n\n                <small className=\"text-muted\">{dateEve}</small>\n              </div>\n            </Link>\n          </div>\n        </div>\n      </div>\n    });\n  const eventContent = [eventHeader, eventList ];\n\n  return (\n    <main>\n      <section className=\"py-5 text-center container\">\n        <div className=\"row\">\n          {\n            !artifact ? <NoticeNoArtifact /> :\n              !contractBilleStore ? <NoticeWrongNetwork /> :\n                eventContent\n          }\n        </div>\n      </section>\n\n\n\n\n    </main>\n  );\n}","import React, {useState} from 'react';\nimport axios from 'axios';\nimport dotenv from 'dotenv';\nimport { useForm } from \"react-hook-form\";\nimport { useNavigate, Link } from 'react-router-dom';\nimport useEth from \"../../contexts/EthContext/useEth\";\n\ndotenv.config();\n\nexport default function FormEvent() {\n  const { state: { accounts, contractBilleStore } } = useEth();\n  const navigate = useNavigate();\n  const { register, handleSubmit } = useForm();\n  const [ isLoading, setIsLoading ] = useState(false);\n  const [ fileImg, setFileImg ] = useState(null);\n\n  const onSubmit = async data => {\n    const { nameEvent } = data;\n    \n    try {\n      setIsLoading(true);\n\n      const cidImage = await sendFileToIPFS(nameEvent);\n      const newData = {...data, uri: cidImage};\n\n      await handleCreateEvent(newData);\n\n    } catch (err) {\n      console.log(\"Error occured\", err);\n    }finally{\n      setIsLoading(true);\n    }\n  }\n\n  const handleCreateEvent = async (params) => {\n    const { dateEvent, nameEvent, symbol, description, uri, ticketSupply1, ticketSupply2, ticketSupply3 } = params;\n    try {\n      const dateTimestamp = Number(new Date(dateEvent));\n      await contractBilleStore.methods.createEvent(dateTimestamp, nameEvent, symbol, description, uri, [ticketSupply1, ticketSupply2, ticketSupply3]).send({ from: accounts[0] });\n      navigate('/');\n    } catch (err) {\n      console.log(\"Erreur\", err);\n    }\n  }\n\n  const sendFileToIPFS = async (eventName) => {\n    const timestamp = Number(Date.now());\n    const fileName = `${fileImg.name}`;\n    const filePath = `/${timestamp}-${eventName}/${fileName}`;\n\n    if (fileImg) {\n      try {\n        const formData = new FormData();\n        formData.append(\"file\", fileImg, filePath);\n\n        const resFile = await axios({\n          method: \"post\",\n          url: \"https://api.pinata.cloud/pinning/pinFileToIPFS\",\n          data: formData,\n          headers: {\n            'pinata_api_key': `${process.env.REACT_APP_PINATA_API_KEY}`,\n            'pinata_secret_api_key': `${process.env.REACT_APP_PINATA_API_SECRET}`,\n            \"Content-Type\": \"multipart/form-data\"\n          },\n        });\n\n        const cidImage = `ipfs://${resFile.data.IpfsHash}/${fileName}`;\n        console.log(\"Image uploaded to Pinata\", cidImage);\n\n        return cidImage;\n\n      } catch (err) {\n        console.log(\"Error sending File to IPFS: \");\n        console.log(err);\n      }\n    }\n  }\n\n  return (\n    <main>\n      <section className=\"py-5 text-center container\">\n        <div className=\"row py-lg-5\">\n          <div className=\"col-lg-6 col-md-8 mx-auto\">\n            <h1 className=\"fw-light\">Ajout nouvel événement</h1>\n          </div>\n        </div>\n      </section>\n\n      <form className=\"p-3 bg-light\" onSubmit={handleSubmit(onSubmit)} >\n\n        <div className=\"mb-3 row\">\n          <label htmlFor=\"imageEvent\" className=\"col-sm-4 col-form-label\">Image événement</label>\n          <div className=\"col-sm-8\">\n            <input type=\"file\" {...register(\"imageEvent\")} onChange={(e) =>setFileImg(e.target.files[0])} />\n          </div>\n        </div>\n\n        <div className=\"mb-3 row\">\n          <label htmlFor=\"nameEvent\" className=\"col-sm-4 col-form-label\">Nom de l'événement</label>\n          <div className=\"col-sm-8\">\n            <input defaultValue=\"Toto\" {...register(\"nameEvent\")} />\n          </div>\n        </div>\n        <div className=\"mb-3 row\">\n          <label htmlFor=\"dateEvent\" className=\"col-sm-4 col-form-label\">Date de l'évènement</label>\n          <div className=\"col-sm-8\">\n            <input defaultValue=\"2022-10-20\" type=\"date\" {...register(\"dateEvent\")} />\n          </div>\n        </div>\n        <div className=\"mb-3 row\">\n          <label htmlFor=\"symbol\" className=\"col-sm-4 col-form-label\">Monnaie</label>\n          <div className=\"col-sm-8\">\n            <input defaultValue=\"BNF\" {...register(\"symbol\")} />\n          </div>\n        </div>\n        <div className=\"mb-3 row\">\n          <label htmlFor=\"description\" className=\"col-sm-4 col-form-label\">Description</label>\n          <div className=\"col-sm-8\">\n            <input defaultValue=\"La legende\" {...register(\"description\")} />\n          </div>\n        </div>\n        <div className=\"mb-3 row\">\n          <label htmlFor=\"ticketSupplies1\" className=\"col-sm-4 col-form-label\">Nombre de tickets Pelouse</label>\n          <div className=\"col-sm-8\">\n            <input type=\"number\" defaultValue={50} {...register(\"ticketSupply1\")} />\n          </div>\n        </div>\n        <div className=\"mb-3 row\">\n          <label htmlFor=\"ticketSupplies2\" className=\"col-sm-4 col-form-label\">Nombre de tickets Gradin</label>\n          <div className=\"col-sm-8\">\n            <input type=\"number\" defaultValue={30} {...register(\"ticketSupply2\")} />\n          </div>\n        </div>\n        <div className=\"mb-3 row\">\n          <label htmlFor=\"ticketSupplies2\" className=\"col-sm-4 col-form-label\">Nombre de tickets VIP</label>\n          <div className=\"col-sm-8\">\n            <input type=\"number\" defaultValue={10} {...register(\"ticketSupply3\")} />\n          </div>\n        </div>\n\n        <div className=\"mb-3 row container text-center\">\n          <div className=\"col\">\n            <button className=\"btn btn-primary\" type=\"submit\" >{\n              isLoading ? <div className=\"spinner-border text-warning\" role=\"status\">\n              <span className=\"visually-hidden\">Loading...</span>\n            </div> : \"Envoyer\"\n            }</button>\n          </div>\n        </div>\n\n      </form>\n\n      <section className=\"py-5 text-center container\">\n        <div className=\"row py-lg-5\">\n          <div className=\"col-lg-6 col-md-8 mx-auto\">\n            <Link to=\"/\" className=\"btn btn-sm btn-outline-secondary\">Tous les événements</Link>\n          </div>\n        </div>\n      </section>\n\n    </main>\n  );\n\n}","import React, { useState, useEffect } from 'react';\nimport { Link, useParams } from \"react-router-dom\";\n\nimport { getContractEventByAddress, isOwner } from \"../../utils\";\nimport useEth from \"../../contexts/EthContext/useEth\";\nimport { getDateFromTimestamp, TICKET_CATEGORIES, TICKET_CATEGORIES_LABELS } from \"../../utils\";\n\nexport default function ViewEvent() {\n  const { state: { web3, accounts, owner, eventsCreated = [] } } = useEth();\n  const [contractBilleEvent, setContractBilleEvent] = useState(null);\n  const [stats, setStats] = useState( { balance: '', ticketsStats: [] });\n\n  const { id } = useParams();\n  const isAdmin = isOwner(accounts, owner);\n  const showEventStats = contractBilleEvent && isAdmin;\n\n  useEffect(() => {\n    if (web3 && (!contractBilleEvent)) {\n      const contractEvent = getContractEventByAddress(web3, id);\n      setContractBilleEvent(contractEvent);\n    }\n  }, [web3, contractBilleEvent, id]);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const [ balance, ticketsStats ] = await Promise.all([\n        contractBilleEvent.methods.getBalance().call({ from: accounts[0]}),\n        contractBilleEvent.methods.getEventStats().call({ from: accounts[0] })\n      ]);\n     \n      setStats ({ ...stats, balance: `${web3.utils.fromWei(balance, 'ether')} Eth`, ticketsStats });\n    }\n\n    if (isAdmin && contractBilleEvent) {\n      fetchData();\n    }\n  }, [web3, accounts, contractBilleEvent, stats, isAdmin]);\n\n  let eventInfos = { date: '', description: '', eventAddress: '', name: '', uri: '' }, eventStats, eventStatsTickets;\n  const [currentEvent] = eventsCreated.filter(({ returnValues: { eventAddress } }) => eventAddress === id);\n\n  if (currentEvent) {\n    const { returnValues: { date, description, eventAddress, name, uri } } = currentEvent;\n    eventInfos = { date: getDateFromTimestamp(date), description, eventAddress, name, uri };\n    \n    // Stats sales / supply by Ticket category\n    eventStatsTickets = TICKET_CATEGORIES.map(i => {\n        return (<div key={i} className=\"row mb-3\">\n          <label htmlFor=\"colFormLabel\" className=\"col-sm-3 col-form-label\">Tickets {`${TICKET_CATEGORIES_LABELS[i]}`}</label>\n          <div className=\"col-sm-9\">\n            <input type=\"email\" className=\"form-control  text-end\" id=\"colFormLabel\" placeholder=\"col-form-label\" value={`${stats.ticketsStats[i]} / ${stats.ticketsStats[i+3]}`} disabled />\n          </div>\n        </div>\n      );\n    })\n\n    // Stats balance\n    eventStats = <section className=\"event-view container py-5 bg-light\">\n      <h4 className=\"fw-light\">Admin - Event stats</h4>\n      <div className=\"row mb-3\">\n          <label htmlFor=\"colFormLabelSm\" className=\"col-sm-3 col-form-label col-form-label\">Balance</label>\n          <div className=\"col-sm-9\">\n            <input type=\"email\" className=\"form-control  text-end\" id=\"colFormLabelSm\" placeholder=\"col-form-label\" value={stats.balance} disabled />\n          </div>\n      </div>\n      {eventStatsTickets}\n    </section>;\n  }\n  \n  return (\n    <main>\n      <section className=\"py-5 text-center container\">\n        <div className=\"row py-lg-5\">\n          <div className=\"col-lg-6 col-md-8 mx-auto\">\n            <h1 className=\"fw-light\">Détails événement</h1>\n            <p className=\"lead text-muted\">\n              <Link type=\"button\" className=\"btn btn-primary\" to={`/buyticket/${id}`}>J'y vais</Link>\n            </p>\n          </div>\n        </div>\n      </section>\n\n      <div className=\"event-view container p-3 bg-light\">\n        <div className=\"row mb-3\">\n          <label htmlFor=\"colFormLabelSm\" className=\"col-sm-3 col-form-label col-form-label\">Date</label>\n          <div className=\"col-sm-9\">\n            <input type=\"email\" className=\"form-control\" id=\"colFormLabelSm\" placeholder=\"col-form-label\" value={eventInfos.date} disabled />\n          </div>\n        </div>\n        <div className=\"row mb-3\">\n          <label htmlFor=\"colFormLabel\" className=\"col-sm-3 col-form-label\">Name</label>\n          <div className=\"col-sm-9\">\n            <input type=\"email\" className=\"form-control\" id=\"colFormLabel\" placeholder=\"col-form-label\" value={eventInfos.name} disabled />\n          </div>\n        </div>\n        <div className=\"row\">\n          <label htmlFor=\"colFormLabelLg\" className=\"col-sm-3 col-form-label col-form-label\">Description</label>\n          <div className=\"col-sm-9\">\n            <input type=\"email\" className=\"form-control\" id=\"colFormLabelLg\" placeholder=\"col-form-label\" value={eventInfos.description} disabled />\n          </div>\n        </div>\n      </div>\n      <br/>\n      {\n        showEventStats && eventStats\n      }\n      <section className=\"py-5 text-center container\">\n        <div className=\"row py-lg-5\">\n          <div className=\"col-lg-6 col-md-8 mx-auto\">\n            <Link to=\"/\" className=\"btn btn-sm btn-outline-secondary\">Tous les événements</Link>\n          </div>\n        </div>\n      </section>\n    </main>\n  );\n}","import React, { useState, useEffect } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport Joi from 'joi';\n\nimport { getContractEventByAddress, isOwner } from \"../../utils\";\nimport useEth from \"../../contexts/EthContext/useEth\";\n\nexport default function FormEvent() {\n  const { state: { web3, accounts, owner } } = useEth();\n  \n  const navigate = useNavigate();\n  let {id} = useParams();\n  \n  const [isLoading, setIsLoading] = useState(false);\n  const [contractBilleEvent, setContractBilleEvent] = useState(null);\n\n  //error list from joi validation\n  const [errlist, setErrlist] = useState([]);\n  // error message from Api request\n  const [errMessage, setErrMessage] = useState('');\n\n  const [ticketOrder , setTicketOrder] = useState({\n    category: 0,\n    quantity: 1\n  });\n\n  const isAdmin = isOwner(accounts, owner);\n\n  useEffect(() => {\n    const fetchData = async(tmp) => {\n      if(tmp){\n        console.log(`🚀 balance Contrat ${id}`, await tmp.methods.getBalance().call({from: accounts[0]}));\n      }\n    }\n\n    if (web3 && id) {\n      const tmp = getContractEventByAddress(web3, id);\n      setContractBilleEvent(tmp);\n\n      if (isAdmin) {\n        fetchData(tmp);\n      }\n    }\n  }, [web3, accounts, id, isAdmin]);\n\n  const handleChange = (e) => {\n    let inputValue = e.target.value;\n    let addedTicketOrder = { ...ticketOrder };\n\n    if(e.target.name)\n      addedTicketOrder[e.target.name] = parseInt(inputValue, 10);\n    else\n      addedTicketOrder[e.target.id] = inputValue;\n\n    setTicketOrder(addedTicketOrder);\n  }\n\n  const handleTicketBuy = async () => {\n    const {category, quantity}= ticketOrder;\n\n    if (contractBilleEvent) {\n      const price = web3.utils.toWei('0.02', 'ether') * quantity;\n\n      try {\n        setIsLoading(true);\n        await contractBilleEvent.methods.buyTickets(category, quantity).send({ from: accounts[0], gas: 3000000, value: price });\n\n        navigate(`/events/${id}`);\n\n      }catch(err) {\n        console.log(`handleTicketBuy: Error `, err);\n        setErrMessage(\"Une erreur est survenue. Essayez ultérieurement.\");\n      }finally {\n        setIsLoading(false);\n      }\n    }else {\n      setErrMessage(\"Une erreur est survenue. Essayez ultérieurement\");\n    }\n  };\n\n  const handleSubmit = async(e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const schema = Joi.object({\n      category: Joi.number().min(0).max(2).required(),\n      quantity: Joi.number().min(1).max(4).required()\n    });\n\n    const joiResponse = schema.validate( ticketOrder  , { abortEarly: false});\n\n    if(joiResponse.error){\n      setErrlist(joiResponse.error.details);\n    }else{\n      setErrlist([]);\n\n      //call Api\n      await handleTicketBuy();\n    }\n    \n  };\n  \n  return(\n    <main>\n      <section className=\"py-5 text-center container\">\n        <div className=\"row py-lg-5\">\n          <div className=\"col-lg-6 col-md-8 mx-auto\">\n            <h1 className=\"fw-light\">Achetez vos tickets</h1>\n            {/* <p className=\"lead text-muted\">Something short and leading about the collection below—its contents, the creator, etc. Make it short and sweet, but not too short so folks don’t simply skip over it entirely.</p> */}\n          </div>\n        </div>\n      </section>\n\n      <form className=\"p-3 bg-light\" onSubmit={handleSubmit}>\n        {\n          errMessage.length ? <div className='alert alert-danger py-1'> {errMessage} </div> : \"\"\n        }\n        {\n          errlist.length ? errlist.map((err,i) => <div key={i} className='alert alert-danger py-1' role=\"alert\"> {err.message}</div>): \"\"\n        }\n        <div className=\"mb-3 row\">\n          <label forhtml=\"category\" className=\"col-sm-4 col-form-label\">Catégorie</label>\n          <div className=\"col-sm-8\">\n            <div className=\"form-check form-check-inline\">\n              <input className=\"form-check-input\" type=\"radio\" name=\"category\" id=\"category1\" value=\"0\" onChange={handleChange} checked={ticketOrder.category === 0} disabled={isLoading} />\n              <label className=\"form-check-label\" forhtml=\"inlineRadio1\">Fosse</label>\n            </div>\n            <div className=\"form-check form-check-inline\">\n              <input className=\"form-check-input\" type=\"radio\" name=\"category\" id=\"category2\" value=\"1\" onChange={handleChange}  checked={ticketOrder.category === 1} disabled={isLoading} />\n              <label className=\"form-check-label\" forhtml=\"inlineRadio2\">Gradins</label>\n            </div>\n            <div className=\"form-check form-check-inline\">\n              <input className=\"form-check-input\" type=\"radio\" name=\"category\" id=\"category3\" value=\"2\" onChange={handleChange}  checked={ticketOrder.category === 2} disabled={isLoading} />\n              <label className=\"form-check-label\" forhtml=\"inlineRadio3\">VIP</label>\n            </div>\n          </div>\n        </div>\n        <div className=\"mb-3 row\">\n          <label htmlFor=\"ticketNumber\" className=\"col-sm-4 form-label\">Nombre de tickets:</label>\n          <div className=\"col-sm-8\">\n            <input type=\"number\" className=\"form-control\" id=\"quantity\" min={1} max={4} onChange={handleChange} defaultValue={1} disabled={isLoading} />\n          </div>\n        </div>\n        <div className=\"mb-3 row container text-center\">\n          <div className=\"col\">\n            <button type=\"submit\" className=\"btn btn-primary\" disabled={isLoading}>{\n              isLoading ? <div className=\"spinner-border text-warning\" role=\"status\">\n              <span className=\"visually-hidden\">Loading...</span>\n            </div> : \"J'achète\"\n            }</button>\n          </div>\n        </div>\n      </form>\n    </main>\n  );\n}\n","import { Link } from \"react-router-dom\";\n\nexport default function NoMatch() {\n  return (\n    <main>\n      <section className=\"py-5 text-center container\">\n        <div className=\"row py-lg-5\">\n          <div className=\"col-lg-6 col-md-8 mx-auto\">\n            <h2>It looks like you're lost...</h2>\n            <p className=\"lead text-muted\">\n              <Link to=\"/\">Go to the home page</Link>\n            </p>\n          </div>\n        </div>\n      </section>\n    </main>\n  );\n}","import { Outlet, useRoutes } from \"react-router-dom\";\n\nimport { EthProvider } from \"./contexts/EthContext\";\nimport Navbar from \"./components/Navbar\";\nimport Listing from \"./components/Listing\";\nimport FormEvent from \"./components/FormEvent\";\nimport ViewEvent from \"./components/ViewEvent\";\nimport FormTicket from \"./components/FormTicket\";\nimport NoMatch from \"./components/NoMatch\";\nimport \"./App.css\";\n\nexport default function App() {\n  let routes = [\n    {\n      path: \"/\",\n      element: <Layout />,\n      children: [\n        { \n            index: true, element: <Listing />,\n        },\n        {\n          path: \"/events/:id\",\n          element: <ViewEvent />,\n        },\n        {\n          path: \"/buyticket/:id\",\n          element: <FormTicket />,\n        },\n        {\n          path: \"/addevent\",\n          element: <FormEvent />,\n        },\n        { path: \"*\", element: <NoMatch /> },\n      ],\n    },\n  ];\n  let element = useRoutes(routes);\n\n  return (\n    <EthProvider>\n      {element}\n    </EthProvider>\n  );\n}\n\n\nfunction Layout() {\n  return (\n    <>\n      <Navbar />\n      <Outlet />\n    </>\n  );\n}","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { BrowserRouter } from \"react-router-dom\";\nimport './index.css';\nimport App from './App';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>\n);\n"],"sourceRoot":""}